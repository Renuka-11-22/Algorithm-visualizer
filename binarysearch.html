<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Binary Search with Graphical Representation</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f9;
      margin: 0;
      padding: 20px;
    }

    h1 {
      text-align: center;
      margin-bottom: 20px;
      color: #f44336;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      background-color: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    input, button {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      font-size: 16px;
      border-radius: 4px;
      border: 1px solid #ccc;
    }

    button {
      background-color: #007bff;
      color: white;
      cursor: pointer;
    }

    button:hover {
      background-color: #0056b3;
    }

    #result {
      margin-top: 20px;
      padding: 10px;
      background-color: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
      border-radius: 4px;
      display: none;
    }

    #graph {
      display: flex;
      justify-content: center;  /* Align bars to the center */
      margin-top: 10px;
    }

    .bar {
      width: 30px;
      background-color: yellow;
      text-align: center;
      color: white;
      border-radius: 10px;
      transition: height 0.3s ease;
      margin: 10px;
      height: 100px;
    }

    .highlight {
      background-color: #ff9800;
    }

    .found {
      background-color: #f44336;
    }

    .info {
      background-color: #d9edf7;
      color: #31708f;
    }
    a{
                color: white;
                text-decoration: none;
            }
  </style>
</head>
<body>
  <div class="container">
    <h1>Binary Search</h1>

    <label for="array">Enter an array of numbers (comma separated):</label>
    <input type="text" id="array" placeholder="e.g., 12, 45, 3, 7, 22">

    <label for="target">Enter target number:</label>
    <input type="number" id="target" placeholder="Target number to search for">
    <button >
        <a href="searching.html">Home</a>
    </button>
    <button onclick="performBinarySearch()">Search</button>
    <div id="result"></div>
    <div id="graph"></div>
  </div>

  <script>
    let currentArray = [];
    let target = null;
    let low, high, mid;

    function performBinarySearch() {
      // Get user input values
      const arrayInput = document.getElementById('array').value;
      target = parseInt(document.getElementById('target').value, 10);

      // Convert the array input string to an actual array of numbers
      currentArray = arrayInput.split(',').map(num => parseInt(num.trim(), 10));

      // Validate the input
      if (currentArray.some(isNaN) || isNaN(target) || target === '') {
        showResult("Please enter a valid array and target number.", "error");
        return;
      }

      // Check if array is sorted (ascending)
      const isSorted = isArraySorted(currentArray);

      // If unsorted, we will sort the array and indicate that sorting is done
      if (!isSorted) {
        showResult("Array was unsorted. Sorting now...", "info");
        currentArray.sort((a, b) => a - b);  // Sort array in ascending order
      }

      // Reset binary search bounds
      low = 0;
      high = currentArray.length - 1;
      clearGraph();
      renderGraph();
      showResult('Searching...', 'info');

      // Start the binary search animation
      binarySearchStepByStep();
    }

    // Binary Search function with animation steps
    function binarySearchStepByStep() {
      if (low <= high) {
        mid = Math.floor((low + high) / 2);
        highlightElement(mid);

        // Check if the middle element is the target
        if (currentArray[mid] === target) {
          setTimeout(() => {
            highlightElement(mid, true);
            showResult('Target:'+target+' found at index' +mid, "success");
          }, 500);
          return;
        }

        // Adjust the search range based on comparison
        if (currentArray[mid] < target) {
          low = mid + 1;
        } else {
          high = mid - 1;
        }

        setTimeout(binarySearchStepByStep, 1000);
      } else {
        showResult('Target: '+ target +' not found', "error");
      }
    }

    // Check if the array is sorted in ascending order
    function isArraySorted(arr) {
      return arr.every((val, i, array) => !i || array[i - 1] <= val);
    }

    // Highlight the current element during search
    function highlightElement(index, found = false) {
      const bars = document.querySelectorAll('.bar');
      if (found) {
        bars[index].classList.add('found');
      } else {
        bars[index].classList.add('highlight');
      }
    }

    // Render the graph (bars) based on the array
    function renderGraph() {
      const graphContainer = document.getElementById('graph');
      graphContainer.innerHTML = '';  // Clear any previous bars

      currentArray.forEach((value, index) => {
        const bar = document.createElement('div');
        bar.classList.add('bar');
        bar.style.height = '${value * 5}px';  // Multiply by 5 for better visibility
        bar.innerText = value;
        graphContainer.appendChild(bar);
      });
    }

    // Clear the graph and reset any visual styles
    function clearGraph() {
      const bars = document.querySelectorAll('.bar');
      bars.forEach(bar => {
        bar.classList.remove('highlight', 'found');
      });
    }

    // Display the result message
    function showResult(message, type) {
      const resultDiv = document.getElementById('result');
      resultDiv.textContent = message;

      // Clear any previous result classes
      resultDiv.classList.remove('success', 'error', 'info');

      // Add the appropriate class for the message type
      if (type === "success") {
        resultDiv.classList.add('success');
      } else if (type === "error") {
        resultDiv.classList.add('error');
      } else {
        resultDiv.classList.add('info');
      }

      resultDiv.style.display = 'block';
    }
  </script>
</body>
</html>